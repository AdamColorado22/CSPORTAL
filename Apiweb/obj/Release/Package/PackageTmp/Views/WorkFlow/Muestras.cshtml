
@{
    ViewBag.Title = "Muestras";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<script src="~/Content/js/jquery-3.5.1.js"></script>
@*<script src="~/Content/js/jquery.auto-complete.js"></script>*@
<link href="~/Content/bootstrap.css" rel="stylesheet" />
<script src="~/Content/js/bootstrap.js"></script>
@*<link href="~/Content/bootstrap.min.css" rel="stylesheet" />*@
<link href="~/Content/Site.css" rel="stylesheet" />
<script src="~/Content/js/toastr.min.js"></script>
<link href="~/Content/css/toastr.min.css" rel="stylesheet" />
<script src="~/Content/js/FormularioCorreo.js" asp-append-version="true"></script>
<script src="~/Content/ckeditor/ckeditor.js"></script>

<div class="row m-4">
    <div class="col-sm-12">
        <div class="card">
            <div class="card-header">
                Muestras
            </div>
            <div class="card-body">
                <table class="table table-striped table-bordered" id="DTable" style="width:100%">
                    <thead>
                        <tr>
                            <th>ID</th>
                            @*<th>PRODUCTO</th>*@
                            <th>DUI</th>
                            <th>IDCLIENTE</th>
                            <th>NOMBRE_PRODUCTO</th>
                            @*<th>TIPO_PROYECTO</th>*@
                            <th>FECHA_REQUERIDA</th>
                            <th>MUESTRA</th>
                            <th>ESTRUCTURA</th>
                            @*<th>CODIGO_U_MUESTRA</th>*@
                            @*<th>PART_ID</th>
                                <th>DUI_MUESTRA</th>
                                <th>MAESTR_ING</th>*@
                            <th>NUM_PEDIDO</th>
                            <th>CANTIDAD</th>
                            @*<th>FORMULA</th>*@
                            <th>P_EQUIPO_TEC</th>
                            <th>EXP_MATERIALES</th>
                            <th>OT</th>
                            <th>FECHA_EST_ENTRAGA</th>
                            <th>TP_CANTIDAD</th>
                            <th>PROCESO_ACTUAL</th>
                            <th>FECHA_INICIO</th>
                            @*<th>PASO ACTUAL</th>*@
                            @*<th>TIEMPO_PROCESO</th>*@
                            @*<th>TIEMPO_TOTAL</th>*@
                            @*<th>FECHA_ESTIMADA</th>*@
                            <th>FECHA_FINALIZACION</th>
                            <th>DIAS_TOTALES</th>

                        </tr>
                    </thead>

                </table>
            </div>
        </div>

    </div>

</div>


<!-- Modal para Muestra y Arte -->
<div class="modal fade" id="ModalCorreo" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header row d-flex justify-content-between mx-1 mx-sm-3 mb-0 pb-0 border-0">
                <h5 class="modal-title" id="exampleModalLabel">listado de Correos</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <table class="table table-sm" id="DtCorreos" style="width:100%">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Usuario</th>
                            <th>Correo</th>
                        </tr>
                    </thead>

                </table>
            </div>

        </div>
    </div>
</div>


@*!-- Modal Agregar o editar -->*@
<div class="modal fade" id="FormModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Workflow</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            @*@using (Html.BeginForm("Guardar", "Workflow", FormMethod.Post, new {  enctype = "multipart/form-data" }))
                {*@
            <div class="modal-body">
                <div class="form-row">


                    <input type="hidden" id="txtid" />



                    @*<div class="form-group col-md-6">
                            <label for="txtcodigoarticulo">CODIGO ARTICULO:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtcodigoarticulo">
                        </div>*@
                    <div class="form-group col-md-6">
                        <label for="txtdui">DUI:</label>
                        <input type="text" autocomplete="off" class="form-control" id="txtdui">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="txtcliente">CLIENTE:</label>
                        <input type="text" autocomplete="off" class="form-control" id="txtcliente">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="txtnombreprod">NOMBRE PRODUCTO:</label>
                        <input type="text" autocomplete="off" class="form-control" id="txtnombreprod">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="txttipos">TIPO PROYECTO:</label>
                        <select class="form-control" id="txttipos">
                            @*<option value="Servicio">Servicio</option>*@
                            <option selected value="Nueva Aplicacion">Nueva Aplicacion</option>
                            <option value="Aplicacion Existente">Aplicacion Existente</option>
                            <option value="Modificación">Modificación</option>

                        </select>


                    </div>
                    <div class="form-group col-md-6">
                        <label for="txtcantidadMuestra">CANT MUESTRA REQ:</label>
                        <input type="text" autocomplete="off" class="form-control" id="txtcantidadMuestra">
                    </div>

                    <div class="form-group col-md-6">
                        <label for="txttiposImpresion">TIPO DE IMPRESION:</label>
                        <select class="form-control" id="txttiposImpresion">
                            @*<option value="Servicio">Servicio</option>*@
                            <option selected value="SIN IMPRESION">SIN IMPRESION</option>
                            <option value="FOTOCELDA/ARTE">FOTOCELDA/ARTE</option>
                            <option value="GENERICO">GENERICO</option>
                            <option value="FULL IMPRESION">FULL IMPRESION</option>
                        </select>


                    </div>
                    <div class="form-group col-md-12">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="chkalimentos">
                            <label class="form-check-label" for="chkalimentos">Empaque para alimentos</label>
                        </div>
                    </div>

                    <div class="form-group col-md-12">
                        <label for="datepicker">FECHA REQUERIDA:</label>
                        <input type="text" id="datepicker" class="form-control" autocomplete="off">
                    </div>




                </div>
            </div>
            <div class="modal-footer">

                <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                <button type="button" id="btnguardari" class="btn btn-primary" onclick="Guardar()">Guardar</button>
            </div>
            @*<div class="form-group col-md-6">
                    <button type="submit" class="btn btn-sm btn-secondary btn-block">Subir archivo</button>
                </div>*@

            @*}*@

        </div>

    </div>
</div>


@*!--ARchivos -->*@
<div class="modal fade " id="FormModal6" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Workflow Adjuntar CoA y FT</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body ">
                <div class="container">
                    @*@using (Html.BeginForm("SubirArchivo", "Workflow",FormMethod.Post,new { id= "frm-adjuntar" }))
                        {*@
                    <form id="uploader">
                        <input type="hidden" id="idWorkflow" name="idWorkflow" />
                        <div class="row">
                            <div class="col-sm-6">
                                <input id="fileInput" type="file" multiple>
                            </div>
                            <div class="col-md-6 left">
                                <button type="submit" id="btnsubmit" class="btn btn-sm btn-primary">
                                    <span class="glyphicon glyphicon-open"></span>
                                    &nbsp;Subir archivo
                                </button>
                            </div>
                        </div>
                        @*}*@
                    </form>
                    <hr />
                    <div class="row">
                        <input type="hidden" id="txtguiid" />
                        <table class="table table-sm" id="Adjuntos" style="width:100%">
                            <thead>
                                <tr>

                                    <th>FECHA SUBIDA</th>
                                    <th>NOMBRE</th>
                                    <th>DESCARGAS</th>


                                </tr>
                            </thead>

                        </table>

                    </div>
                </div>
            </div>
            @*<div class="modal-footer">

                    <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" onclick="Siguiente()">Guardar</button>

                </div>*@

        </div>

    </div>
</div>



@*<div class="modal fade" id="FormModal3" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Workflow</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="txtmuestra">MUESTRA:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtmuestra">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="txtmuestracodigo">CODIGO UNICO MUESTRA:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtmuestracodigo">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="txtcodigodui">NUMERO DE DUI MUESTRA:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtcodigodui">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="txtmaestro">MAESTRO DE INGENIERIA:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtmaestro">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="txtcantidadmuestra">CANTIDAD:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtcantidadmuestra">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="txtformulae">FORMULA:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtformulae">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="estructurae">ESTRUCTURA:</label>
                            <input type="text" autocomplete="off" class="form-control" id="estructurae">
                        </div>

                        <div class="form-group col-md-12">
                            <label for="txtequipotec">PRESENCIA EQUIPO TECNICO:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtequipotec">
                        </div>
                        <div class="form-group col-md-12">
                            <label for="txtexplosion">EXPLOSION DE MATERIALES:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtexplosion">
                        </div>

                    </div>
                </div>
                <div class="modal-footer">

                    <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-primary" onclick="Siguiente()">Guardar</button>

                </div>

            </div>

        </div>
    </div>*@


<div class="modal fade" id="FormModal4" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Workflow</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-row">


                    <div class="form-group col-md-12">
                        <label for="txtot">ORDEN DE TRABAJO:</label>
                        <input type="text" autocomplete="off" class="form-control" id="txtot">
                    </div>
                    <div class="form-group col-md-12">
                        <label for="datepicker4">FECHA ESTIMADA DE ENTREGA:</label>
                        <input type="text" id="datepicker4" class="form-control" autocomplete="off">
                    </div>

                </div>
            </div>
            <div class="modal-footer">

                <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" onclick="Siguiente()">Guardar</button>

            </div>

        </div>

    </div>
</div>



<!-- Modal -->
<div id="FormModal3" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" class="modal fade text-left">
    <div role="document" class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header row d-flex justify-content-between mx-1 mx-sm-3 mb-0 pb-0 border-0">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" href="#tab02">Detalle</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#tab03">Comentarios</a>
                    </li>
                </ul>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="line"></div>
            <div class="modal-body">
                <div class="tab-content">
                    <div id="tab02" class="tab-pane fade show active">
                        <h5 class="text-center mb-4 mt-0 pt-4">Detalle</h5>
                        <div class="form-group col-md-12">
                            <label for="txtmuestra">MUESTRA:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtmuestra">
                        </div>
                        <div class="form-group col-md-12">
                            <label for="txtmuestracodigo">CODIGO UNICO MUESTRA:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtmuestracodigo">
                        </div>
                        <div class="form-group col-md-12">
                            <label for="txtcodigodui">NUMERO DE DUI MUESTRA:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtcodigodui">
                        </div>
                        <div class="form-group col-md-12">
                            <label for="txtmaestro">MAESTRO DE INGENIERIA:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtmaestro">
                        </div>
                        <div class="form-group col-md-12">
                            <label for="txtcantidadmuestra">CANTIDAD:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtcantidadmuestra">
                        </div>
                        <div class="form-group col-md-12">
                            <label for="txtformulae">FORMULA:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtformulae">
                        </div>
                        <div class="form-group col-md-12">
                            <label for="estructurae">ESTRUCTURA:</label>
                            <input type="text" autocomplete="off" class="form-control" id="estructurae">
                        </div>
                        <div class="form-group col-md-12">
                            <label for="txtequipotec">PRESENCIA EQUIPO TECNICO:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtequipotec">
                        </div>
                        <div class="form-group col-md-12">
                            <label for="txtexplosion">EXPLOSION DE MATERIALES:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtexplosion">
                        </div>
                    </div>
                    <div id="tab03" class="tab-pane fade">
                        <div class="bg-light">
                            <h5 class="text-center mb-4 mt-0 pt-4">Comentarios</h5>
                            <div class="form-group col-md-12">
                                <label for="txtcomentarios2">COMENTARIOS:</label>
                                <textarea class="form-control" id="txtcomentarios2" rows="5"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
       
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" onclick="Siguiente()">Guardar</button>
            </div>
        </div>
    </div>
</div>




<div class="modal fade" id="FormModal5" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Workflow</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">

                <div class="form-row">
                    <div class="form-group col-md-12">
                        <label for="txtcantidades">CANTIDADES:</label>
                        <input type="text" autocomplete="off" class="form-control" id="txtcantidades">
                    </div>
                    <div class="form-group col-md-12">
                        <label for="txtcomentarios">COMENTARIOS:</label>
                        <textarea class="form-control" id="txtcomentarios" rows="5"></textarea>

                    </div>


                </div>
            </div>
            <div class="modal-footer">

                <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" onclick="Siguiente()">Guardar</button>

            </div>

        </div>

    </div>
</div>


<div class="modal fade" id="FormModal7" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Workflow</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-row">

                    <div class="form-group col-md-12">
                        <label for="txtaprovada">APROBADA:</label>
                        <select class="form-control" id="txtaprovada">
                            @*<option value="Servicio">Servicio</option>*@
                            <option selected value="SI">SI</option>
                            <option value="NO">NO</option>
                        </select>


                    </div>

                    @*<div class="form-group col-md-12">
                            <label for="txtaprovada">APROVADA:</label>
                            <input type="text" autocomplete="off" class="form-control" id="txtaprovada">
                        </div>*@
                    <div class="form-group col-md-12">
                        <label for="datepicker5">FECHA DE VALIDACION:</label>
                        <input type="text" id="datepicker5" class="form-control" autocomplete="off">
                    </div>

                </div>
            </div>
            <div class="modal-footer">

                <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" onclick="Siguiente()">Guardar</button>

            </div>

        </div>

    </div>
</div>



<div class="modal fade" id="FormModal8" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Workflow</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-row">

                    <div class="form-group col-md-12">
                        <label for="txtpaso">PASO:</label>
                        <select class="form-control" id="txtpaso">
                            @*<option value="Servicio">Servicio</option>*@
                            <option selected value="LOTE INDUSTRIAL">LOTE INDUSTRIAL</option>
                            <option value="MUESTRA">MUESTRA</option>
                            <option value="ARTICULO">ARTICULO</option>
                        </select>


                    </div>

                    <div class="form-group col-md-12">
                        <label for="txtcantidalote">CANTIDAD LOTE:</label>
                        <input type="text" autocomplete="off" class="form-control" id="txtcantidalote">
                    </div>


                </div>
            </div>
            <div class="modal-footer">

                <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" onclick="Siguiente()">Guardar</button>

            </div>

        </div>

    </div>
</div>

@section scripts
    {


    <script>

        var table, tableA;
        $("#exampleModal").draggable({
            handle: ".modal-header"
        });

        $('#datepicker').datepicker({
            uiLibrary: 'bootstrap4',
            dateFormat: 'dd/mm/yy'
        });
        $('#datepicker2').datepicker({
            uiLibrary: 'bootstrap4',
            dateFormat: 'dd/mm/yy'
        });
        $('#datepicker4').datepicker({
            uiLibrary: 'bootstrap4',
            dateFormat: 'dd/mm/yy'
        });
        $('#datepicker5').datepicker({
            uiLibrary: 'bootstrap4',
            dateFormat: 'dd/mm/yy'
        });
        $('#FormModal6').on('hidden.bs.modal', function (e) {
            tableA.destroy();
        })


        $('#WorkflowMuestra').addClass('active');
        $('#Workflowbart').removeClass('active');
        $('#Workflowb2b').removeClass('active');
        $('#Bodega1').removeClass('active');
        $('#navhist').removeClass('active');
        $('#navsmi').removeClass("active");
        $('#navmh').removeClass("active");
        $('#navhome').removeClass("active");
        $('#navqw2').removeClass("active");
        $('#navqw7').removeClass("active");
        $('#navqw62').removeClass("active");

        $(document).ready(function () {

            CKEDITOR.replace('txtcomentarios');
            CKEDITOR.replace('txtcomentarios2');
            mostrar();


            document.getElementById('uploader').onsubmit = function () {
                var formdata = new FormData(); //FormData object
                var idworkflow = document.getElementById('idWorkflow').value;
                var fileInput = document.getElementById('fileInput');

                //Iterating through each files selected in fileInput
                formdata.append('idWorkflow', idworkflow);
                formdata.append('tipo', 'MUE');
                for (i = 0; i < fileInput.files.length; i++) {
                    //Appending each file to FormData object
                    formdata.append(fileInput.files[i].name, fileInput.files[i]);
                }
                //Creating an XMLHttpRequest and sending
                var xhr = new XMLHttpRequest();
                xhr.open('POST', '/Workflow/SubirArchivo');
                xhr.send(formdata);
                xhr.onreadystatechange = function () {
                    if (xhr.readyState == 4 && xhr.status == 200) {
                        //toastr.success('Archivo Adjuntado', 'Completado', { timeOut: 3000, "closeButton": true, "positionClass": "toast-top-left" });
                        tableA.destroy();
                        tableA.ajax.reload();

                        archivos(table.rows({ selected: true }).data()[0].ID);
                        //limpiar();
                    }
                }
                return false;
            }



        });

        function archivos($ID) {
            $("#idWorkflow").val($ID);
            TablaAdjuntos($ID);
            $('#FormModal6').modal('show');
        }


        function mostrar()
        {

            table = $('#DTable').DataTable({
                responsive: true,
                dom: "Bfrltip",
                "scrollY": "500px",
                "iDisplayLength": -1,
                "lengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                ajax: "/Workflow/ListaMuestras",
                //"createdRow": function (row, data, dataIndex) {
                //    if (data.PASO_ACTUAL =10) {
                //        $(row).css("background-color", "#40CFFF");

                //    }
                //    },

                columns: [
                    { data: "ID" },
                   /* { data: "PRODUCTO" },*/
                    { data: "DUI" },
                    { data: "IDCLIENTE" },
                    { data: "NOMBRE_PRODUCTO" },
                /*    { data: "TIPO_PROYECTO" },*/
                    { data: "FECHA_REQUERIDA" },
                    { data: "MUESTRA" },
                    { data: "ESTRUCTURA" },
                    //{ data: "CODIGO_U_MUESTRA" },
                    //{ data: "PART_ID" },
                    //{ data: "DUI_MUESTRA" },
                    //{ data: "MAESTR_ING" },
                    { data: "NUM_PEDIDO" },
                    { data: "CANTIDAD" },
                    /*{ data: "FORMULA" },*/
                    { data: "P_EQUIPO_TEC" },
                    { data: "EXP_MATERIALES" },
                    { data: "OT" },
                    { data: "FECHA_EST_ENTRAGA" },
                    { data: "TP_CANTIDAD" },
                    { data: "PROCESO_ACTUAL" },
                    { data: "FECHA_INICIO" },

                    //{ data: "PASO_ACTUAL" },
                    //{
                    //    data: null,
                    //    title: "TIEMPO PROCESO",
                    //    render: function (data, row, meta) {
                    //        var cumplimiento, estilo;
                    //        if (data.TIEMPO_PROCESO > 0) {
                    //            cumplimiento = (data.TIEMPO_PROCESO * 100).toFixed(2);
                    //            if (cumplimiento > 0 && cumplimiento < 40) {
                    //                estilo = 'width:' + cumplimiento + '%; background-color: green';
                    //            }
                    //            else if (cumplimiento >= 40 && cumplimiento < 80) {

                    //                estilo = 'width:' + cumplimiento + '%; background-color: yellow';
                    //            }
                    //            else if (cumplimiento >= 80) {

                    //                estilo = 'width:' + cumplimiento + '%; background-color: red';
                    //            }

                    //        }
                    //        else
                    //            cumplimiento = 0;
                    //        return '<div class="progress"> <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="' + estilo + '" aria-valuenow="' + cumplimiento + '" aria-valuemin="0" aria-valuemax="100"> <span style="color:black" >' + cumplimiento + '% </span></div></div>';

                    //    }
                    //},
                    //{
                    //    data: null,
                    //    title: "TIEMPO TOTAL",
                    //    render: function (data, row, meta) {
                    //        var cumplimiento, estilo;
                    //        if (data.TIEMPO_TOTAL > 0) {
                    //            cumplimiento = (data.TIEMPO_TOTAL * 100).toFixed(2);
                    //            if (cumplimiento > 0 && cumplimiento < 40) {
                    //                estilo = 'width:' + cumplimiento + '%; background-color: green';
                    //            }
                    //            else if (cumplimiento >= 40 && cumplimiento < 80) {

                    //                estilo = 'width:' + cumplimiento + '%; background-color: yellow';
                    //            }
                    //            else if (cumplimiento >= 80) {

                    //                estilo = 'width:' + cumplimiento + '%; background-color: red';
                    //            }

                    //        }
                    //        else
                    //            cumplimiento = 0;
                    //        return '<div class="progress"> <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="' + estilo + '" aria-valuenow="' + cumplimiento + '" aria-valuemin="0" aria-valuemax="100"> <span style="color:black" >' + cumplimiento + '% </span></div></div>';

                    //    }
                    //},
                    { data: "FECHA_FINALIZACION" },

                    { data: "DIAS_TOTALES" },
                   /* { data: "FECHA_ESTIMADA" },*/



                ],

                order: [0, 'desc'],

                select: true,
                buttons: [

                    {
                        text: '<a ><i class="fas fa-plus-circle fa-lg"  style="color:#007bff"></i>&nbsp; Nuevo</a>',
                        titleAttr: 'Agregar Nuevo',
                        action: function (e, dt, node, config) {
                            $('#btnguardari').prop("disabled", false);
                            $('#FormModal').modal('show');
                        }
                    },

                    {
                        extend: 'excelHtml5',
                        text: '<i class="fas fa-file-excel" style="color:green"></i> ',
                        titleAttr: 'Exportar a Excel',
                        className: 'btn btn-success btn-sm'
                    },
                   {
                        extend: 'print',
                        text: '<i class="fa fa-print"></i> ',
                        titleAttr: 'Print',
                        className: 'btn btn-info'
                    },

                    {
                        text: '<i class="fas fa-check-square"></i>',
                        extend: 'selectAll',
                        className: 'btn-space'
                    },
                    {
                        text: '<i class="far fa-check-square"></i>',
                        extend: 'selectNone',
                        className: 'btn-space'
                    },
                    {
                        text: '<i class="fas fa-sync-alt" style="color:green"></i>',
                        titleAttr: 'Actualizar',
                        action: function (e, dt, node, config) {
                            $('#DTable').DataTable().ajax.reload();

                        }
                    },
                    {
                        text: '<a><i class="fas fa-caret-square-right" style="color:#229E51"></i>&nbsp; Siguiente Proceso</a>',
                        titleAttr: 'Siguiente',
                        action: function (e, dt, node, config) {
                            if (table.rows('.selected').data().length > 0) { Paso(table.rows({ selected: true }).data()[0].PASO_ACTUAL); }
                            else {
                                toastr.error('Debe Seleccionar al menos un Registro', 'Alerta', { timeOut: 3000, "closeButton": true, "positionClass": "toast-top-left" });
                            }

                        }
                    },
                    {
                        text: '<i class="fas fa-file-upload"></i>',
                        titleAttr: 'Adjuntos',
                        action: function (e, dt, node, config) {
                            if (table.rows('.selected').data().length > 0) { archivos(table.rows({ selected: true }).data()[0].ID); }
                            else {
                                toastr.error('Debe Seleccionar al menos un Registro y en estado Finalizado', 'Alerta', { timeOut: 3000, "closeButton": true, "positionClass": "toast-top-left" });
                            }

                        }
                    },

                    {
                        text: '<a><i class="fas fa-at"></i></i>&nbsp; Correo</a>',
                        titleAttr: 'Correo',
                        action: function (e, dt, node, config) {
                            if (table.rows('.selected').data().length > 0) { habilitarCorreo("MUE", table.rows({ selected: true }).data()[0].PASO_ACTUAL); }
                            else {
                                toastr.error('Debe Seleccionar al menos un Registro y en estado Finalizado', 'Alerta', { timeOut: 3000, "closeButton": true, "positionClass": "toast-top-left" });
                            }

                        }
                    },

                ],
                language: {
                   url: "@Url.Content("~/Content/idioma/datatable.es-ES.json")"
                }
            });
        }

        function Paso($CORREL) {

            switch ($CORREL)

            {
                case 10:
                    $('#FormModal3').modal('show');
                    break;
                case 20:
                    $('#FormModal4').modal('show');
                    break;
                case 30:
                    $('#FormModal5').modal('show');
                    break;
                case 40:
                    $('#FormModal7').modal('show');
                    break;
                case 50:
                    $('#FormModal8').modal('show');
                    break;

            }
        }


             function TablaAdjuntos($ID)
        {
           /* $.fn.dataTable.moment('DD/MM/YYYY');*/


            tableA= $('#Adjuntos').DataTable({
                responsive: true,
                dom: "Bfrltip",
                /*"scrollY": "500px",*/
                "iDisplayLength": 10,
                "lengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                ajax: "/Workflow/Ver?idworkflow=" + $ID+"&tipo=MUE",


                columns: [

                    { data: "Extension" },
                    /*{ data: "Nombre" },*/
                    {
                        data: "Nombre", "render": function (data, type, row) {

                            return "<a  href='/Workflow/DescargarArchivo/?id=" + row.Id + "'><i class='fas fa-cloud-download-alt'></i> " + row.Nombre  + "</a>"

                        }

                    },
                    { data: "Descargas" },



                ],

                buttons: [
                    {
                        text: '<a ><i class="fas fa-trash" style="color:red" ></i></a>',
                        titleAttr: 'Eliminar',
                        action: function (e, dt, node, config) {
                            if (table.rows('.selected').data().length > 0) { Eliminar(tableA.rows({ selected: true }).data()[0].Id); }
                            else {
                                toastr.error('Debe Seleccionar al menos un Registro', 'Alerta', { timeOut: 3000, "closeButton": true, "positionClass": "toast-top-left" });
                            }
                        }
                    },],

                order: [0, 'asc'],

                select: true,

                language: {
                   url: "@Url.Content("~/Content/idioma/es-ES.json")"
                }
            });
        }



        function limpiar()
        {

            $("#txtequipotec").val("");
            $("#txtexplosion").val("");
            $("#txtmuestra").val("");
            $("#txtmuestracodigo").val("");
            $("#txtmaestro").val("");
            $("#txtcodigodui").val("");
            $("#txtcantidadmuestra").val("");
            $("#txtformulae").val("");
            $("#estructurae").val("");
            $("#txtdui").val("");
            $("#txtcliente").val("");
            $("#txtnombreprod").val("");
            $("#txttipos").val("");
            $("#datepicker").val("");
            $("#txtcantidadMuestra").val("");
            $("#txttiposImpresion").val("");
            $("#chkalimentos").val("");
            table.clear().draw();
            table.destroy();
            mostrar();
        }

        function Siguiente() {

            var Seleccion = table.rows({ selected: true }).data()[0];

            switch (Seleccion.PASO_ACTUAL) {

                case 10:
                    $('#txtcomentarios2').val(CKEDITOR.instances["txtcomentarios2"].getData());
                    Seleccion.P_EQUIPO_TEC = $("#txtequipotec").val();
                    Seleccion.EXP_MATERIALES = $("#txtexplosion").val();
                    Seleccion.MUESTRA = $("#txtmuestra").val();
                    Seleccion.CODIGO_U_MUESTRA = $("#txtmuestracodigo").val();
                    Seleccion.MAESTR_ING = $("#txtmaestro").val();
                    Seleccion.DUI_MUESTRA = $("#txtcodigodui").val();
                    Seleccion.CANTIDAD = $("#txtcantidadmuestra").val();
                    Seleccion.FORMULA = $("#txtformulae").val();
                    Seleccion.ESTRUCTURA = $("#estructurae").val();
                    Seleccion.COMENTARIOS2 = $("#txtcomentarios2").val();

                    var adicional = { TIPO: "MUE" };
                    Object.assign(Seleccion, adicional);
                    break;
                case 20:
                    Seleccion.OT = $("#txtot").val();
                    Seleccion.FECHA_EST_ENTRAGA = $("#datepicker4").val();
                    var adicional = {  TIPO: "MUE" };
                    Object.assign(Seleccion, adicional);
                    break;
                case 30:
                    $('#txtcomentarios').val(CKEDITOR.instances["txtcomentarios"].getData());
                    var adicional = { TP_CANTIDAD: $("#txtcantidades").val(), COMENTARIOS: $("#txtcomentarios").val(), TIPO: "MUE" };
                    Object.assign(Seleccion, adicional);
                    break;
                case 40:
                    var adicional = { APROBADA: $("#txtaprovada").val(), FECHA_VALIDACION_C: $("#datepicker5").val(), TIPO: "MUE" };
                    Object.assign(Seleccion, adicional);

                    break;
                case 50:
                    var adicional = { PASO: $("#txtpaso").val(), CANTIDAD_LOTE: $("#txtcantidalote").val(), TIPO: "MUE" };
                    Object.assign(Seleccion, adicional);
                    break;

            }



            jQuery.ajax({
                    url: "@Url.Action("SiguienteMue", "Workflow")",
                    type: "POST",
                data: JSON.stringify({ objeto: Seleccion }),
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                 success: function (response) {
                     if (response.success === true) {
                          toastr.success(response.message, 'Completado', { timeOut: 3000, "closeButton": true, "positionClass": "toast-top-left" });
                            $('#FormModal').modal('hide');
                            limpiar();

                        }
                        else { toastr.error(response.message, 'Alerta', { timeOut: 3000, "closeButton": true, "positionClass": "toast-top-left" }); }
                    }

            });

            $('#FormModal21').modal('hide');
            $('#FormModal2').modal('hide');
            $('#FormModal3').modal('hide');
            $('#FormModal4').modal('hide');
            $('#FormModal8').modal('hide');
            $('#FormModal7').modal('hide');
            $('#FormModal5').modal('hide');
        }

        function Guardar()
        {
            var Workflow = {
                ID: 0,
                PASO_ACTUAL: 0,
                DUI: $("#txtdui").val(),
                IDCLIENTE: $("#txtcliente").val(),
                NOMBRE_PRODUCTO: $("#txtnombreprod").val(),
                TIPO_PROYECTO: $("#txttipos").val(),
                FECHA_REQUERIDA: $("#datepicker").val(),
                CANT_MUESTRA_REQ: $("#txtcantidadMuestra").val(),
                TIPO_IMPRESION: $("#txttiposImpresion").val(),
                EMPAQUE_ALIMENTOS: $('#chkalimentos').prop('checked'),
            }




             jQuery.ajax({
                    url: "@Url.Action("GuardarMue", "Workflow")",
                    type: "POST",
                 data: JSON.stringify({ objeto: Workflow }),
                    dataType: "json",
                    contentType: "application/json; charset=utf-8",
                 success: function (response) {
                     if (response.success === true) {
                          toastr.success(response.message, 'Completado', { timeOut: 3000, "closeButton": true, "positionClass": "toast-top-left" });
                            $('#FormModal').modal('hide');
                            limpiar();

                        }
                        else { toastr.error(response.message, 'Alerta', { timeOut: 3000, "closeButton": true, "positionClass": "toast-top-left" }); }
                    }



             });



        }

    </script>




}